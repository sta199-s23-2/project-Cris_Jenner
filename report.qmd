---
title: "County Demographics: What Factors Influence Career Outcomes"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

***Introduction***

There are persistent problems and injustices in the United States around educational and income inequality. For our research project, we are going to examine what factors influence career outcomes (one's education and income) by looking at data from over 3,000 counties in the United States.

In many cases, these education and income are very interrelated for families and counties causing or exacerbating a vicious cycle that can be hard to break. In America, there are many root causes that contribute to such a cycle, and it is important they are clearly researched and evaluated, so changes can start to be made to populations and counties that need them most. There are many factors that can influence one's career outcomes, but some particularly important ones are education level, ethnicity, gender, and state. According to the APLU, people who hold college degrees are twice as likely to get a job and make around an extra \$1.2 million over the course of their life (APLU). Black or Latino families make around 50% of what white households do, according to the Federal Reserve Board (Federal Reserve Board). The gender pay gap still persists, with women earning an average of 82% of what men do (PEW Research Center). On the state level, various factors such as funding per county and class disparities can impact income inequality as well. There are intersections in everyone's identities and therefore the counties identities as well, and when combined, can have even greater impacts on career outcomes, so knowing which specific identities are most vulnerable is also a key step to making actionable change. We believe counties with residents with higher levels of education, a higher white population, more males, and live in states with greater funding and job opportunities will have better career outcomes. Since this data has been gathered by the US Census Bureau, a government organization, there should be no ethical concerns. They adhere to strict privacy policy guidelines to ensure a confidential, respectful, and transparent experience for participants when collecting data (United States Census Bureau).

<https://www.census.gov/about/policies/privacy/data_stewardship/our_privacy_principles.html>

<https://www.aplu.org/our-work/4-policy-and-advocacy/publicuvalues/employment-earnings/#:~:text=The%20evidence%20that%20a%20college,on%20average%20over%20their%20lifetime>.

<https://www.federalreserve.gov/econres/notes/feds-notes/wealth-inequality-and-the-racial-wealth-gap-20211022.html#:~:text=In%20the%20United%20States%2C%20the,percent%20as%20much%20net%20wealth>.

<https://www.pewresearch.org/fact-tank/2023/03/01/gender-pay-gap-facts/#:~:text=The%20gender%20gap%20in%20pay,%2D%20and%20part%2Dtime%20workers>.

\
***Data***

The dataset we are analyzing is from The Collection of Really Great, Interesting, Situated Datasets (CORGIS) Project. Furthermore, it was collected using 2010 to 2019 data from the United States Census Bureau. It should be noted that some of the estimates came from sample data. The dataset includes a wide variety of observations for various counties in the United States. In order to best serve our research question, we will focus on the statistics such as education level, ethnicity, age, gender, and state. The data is largely qualitative and in terms of what percentage of the county fits a certain description such as being a high school graduate or white.\

***Methodology***

```{r}
#| label: load-pkgs
#| message: false
#| warning: false

library(tidyverse)
library(usmap)
library(geofacet)
```

```{r}
#| label: load-data-2
#| message: false
#| warning: false

counties <- read_csv("data/county_demographics.csv")
```

```{r}
#| label: mean_white

counties |>
  summarize(mean(`Ethnicities.White Alone	 not Hispanic or Latino`))
```

```{r}
#| label: mean_income_above

counties_white <- counties |>
  filter(`Ethnicities.White Alone	 not Hispanic or Latino` >= 75.83992)

counties_white |>
  summarize(mean_income_white = mean(`Income.Median Houseold Income`))
```

```{r}
#| label: mean_income_below

counties_nonwhite <- counties|>
  filter(`Ethnicities.White Alone	 not Hispanic or Latino` <= 75.83992) 

counties_nonwhite |>
  summarize(mean_income_nonwhite = mean(`Income.Median Houseold Income`))
```

```{r}
#| label: income
#| message: false
#| warning: false

statepop <- statepop

state_data <- counties |>
  group_by(State) |>
  summarize(median_income = median(`Income.Median Houseold Income`),
            median_education = median(`Education.Bachelor's Degree or Higher`))

maps_dataframe <- full_join(statepop, state_data, by = c("abbr" = "State")) 

plot_usmap(data = maps_dataframe,
           values = "median_income",
           labels = TRUE) +
  labs(fill = "Median Household Income", 
       title = "Household Incomes Per State") +
  scale_fill_viridis_c() +
  theme(legend.position = "bottom") 

```

```{r}
#| label: education
#| message: false
#| warning: false

plot_usmap(data = maps_dataframe,
           values = "median_education",
           labels = TRUE) +
  labs(fill = "Median Education Levels", 
       title = "Education Levels Per State") +
  scale_fill_viridis_c() +
  theme(legend.position = "bottom") 

```

```{r}
#| label: gender
#| message: false
#| warning: false

by_gender <- counties |>
  group_by(State) |>
  summarize(percent_female = median(`Miscellaneous.Percent Female`),
            percent_male = median(100 - `Miscellaneous.Percent Female`))

maps_dataframe1 <- full_join(statepop, by_gender, by = c("abbr" = "State")) 

plot_usmap(data = maps_dataframe1,
           values = "percent_female",
           labels = TRUE) +
  labs(fill = "Median percent female", 
       title = "Gender Breakdowns By State") +
  scale_fill_viridis_c() +
  theme(legend.position = "bottom") 

```

```{r}
#| label: age
#| message: false
#| warning: false

by_age <- counties |>
  group_by(State) |>
  summarize(percent_elderly = median(`Age.Percent 65 and Older`))

maps_dataframe2 <- full_join(statepop, by_age, by = c("abbr" = "State")) 

plot_usmap(data = maps_dataframe2,
           values = "percent_elderly",
           labels = TRUE) +
  labs(fill = "Median percent of population over 65 years old", 
       title = "Elderly Populations Breakdowns By State") +
  scale_fill_viridis_c() +
  theme(legend.position = "bottom") 
```

```{r}
#| label: changing variables

counties <- counties |>
  rename(income = `Income.Median Houseold Income`,
         education = `Education.Bachelor's Degree or Higher`)

```

```{r}
#| label: lin_reg_age_gender
#| eval: false

linear_reg() |>
  set_engine("lm") |>
  fit(income ~ education, data = counties) |>
  pull(adj.r.squared)
```

```{r}
#| label: lin_reg_education
#| eval: false

lm(income ~ education, 
      data = counties) |>
  pull(adj.r.squared)
```

We first summarized our data (finding median income, education levels, etc.) and manipulated it (using full_join) in order to create Choropleth maps of the US. Each state is colored based on the median values of different variables, including percent of elderly population, percent female population, median education levels, and median household income. We chose to create these maps as they helped us visualize geographic patterns within the US based on the spectrum of colors by state. Finally, we used linear regression analysis to model the relationships between variables like age and income.

***Results***

First of all, according to the map visualization, median household income levels appear to be the lowest in the southern regions, particularly in the southeast. They tend to be the highest in the northeast and west. This trend is very similar for the map visualization of median education levels, but the difference between the regions is not as extreme. There are very high median education levels in the northeast compared to the rest of the country.

Additionally, within each state's population, there seems to be a lower percent of females in the northwest and west (\~48% to 50%), while there seems to be a higher percent of females comparatively in the east and southeast regions.

The percent elderly in the US among states seems to be very scattered among regions. Among all states, Montana seems to have the greatest elderly population while Utah and Alaska seem to have the lowest. It seems that states in the northwest seem to have the greatest elderly populations, although the correlation among region seems to be weak.

We can see the relationships between income, age, gender, and education below through the following linear regression models.

$\widehat{Median\_Household\_Income} = 61790 - 799.7*Percent\_65\_and\_Older + 150.2*Percent\_Female$

Holding percent of women in each county constant, for a one percent increase in percent of county citizens 65 years or older, we estimate a mean change in median household income of -799.70 dollars. Therefore, as elderly population increases, income decreases.

Holding percent of citizens 65 years or older, for a one percent increase in percent of women in each county, we estimate a mean change in median household income of \$150.20.

According to the mean summary statistics of percentage of persons of white ethnicity per county, there is a decrease in median household income between above average percentage of white persons and below average percentage of white persons. There is a decrease of \$1945.99 in median household income.

$\widehat{Median\_Household\_Income} = 30418 + 1049*Percent\_College\_Degree$

For a one percent increase in percent of county citizens with a college degree, we estimate a mean change in median household income of 1049 dollars.
